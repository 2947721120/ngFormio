!function(){"use strict";var app=angular.module("formio",["ngSanitize","ui.bootstrap","ui.bootstrap.datetimepicker","ui.select","angularMoment","bgf.paginateAnything"]);app.provider("Formio",function(){var e="",o=!1,t="",n={},i=function(e){return e.match(/^(http[s]?:\/\/)([^/]+)($|\/.*)/)},r=function(e){if(t)return t;if(!e)return"";var o=i(e);if(o.length<=2)return o.join(".");var n=o[2].split(".");n.length>2&&n.splice(0,n.length-2);var r=n.join(".");return t=o[1]+r,t+=o.length>3?o[3]:""};return{setBaseUrl:function(t,n){o=n,e=t},$get:["$http","$q","formioInterceptor","$location",function(t,s,a,l){var p=s.defer(),m=function(t){if(!(this instanceof m))return new m(t);if(t){this.appUrl="",this.appId="",this.appId="",this.formUrl="",this.formsUrl="",this.formId="",this.submissionsUrl="",this.submissionUrl="",this.submissionId="",this.actionsUrl="",this.actionId="",this.actionUrl="",0!==t.indexOf("http")&&0!==t.indexOf("//")&&(e=e?e:l.absUrl().match(/http[s]?:\/\/[^/?]*/)[0]+"/app/api",t=e+t);var n=i(t),r=n.length>2?n[2].split("."):[],s="";!o&&(2===r.length&&0===r[1].indexOf("localhost")||r.length>=3)&&(s=r[0],this.appId=s);var a=t.match(/\/(submission|action)\/?([^?]*)/);a&&a.length>1&&a.shift(),t=t.replace(/\/(submission|action).*/,"");var p=[];if(s)p=t.match(/(http[s]?:\/\/.*app\/api)\/?([^?]*)?/),p.length>1&&p.shift();else{var c=t.match(/^http.*\/.*\/form\/?([^?]*)/);c&&c.length>1?(p[1]=c[1]?"form/"+c[1]:"",p[0]=p[1]?t.replace("/"+p[1],""):t):p[0]=t}p.length>0&&(this.appUrl=p.length>0?p[0]:"",this.appId=!0,this.formsUrl=this.appUrl?this.appUrl+"/form":"",this.formId=p.length>1?p[1]:"",this.formUrl=this.appUrl?this.appUrl+"/"+this.formId:"",this.pathType=a&&a.length>0?a[0]:"",angular.forEach(["submission","action"],function(e){var o=e+"sUrl",t=e+"Id",n=e+"Url";this[o]=this.formUrl?this.formUrl+"/"+e:"",this[t]=a&&this.pathType===e&&a.length>1?a[1]:"",this[n]=this[t]?this[o]+"/"+this[t]:this[o]}.bind(this)))}},c=function(e){return function(o){"Unauthorized"===o&&p.reject(o),e.reject(o)}},u=function(e,o){var i=s.defer();if(!e)return i.promise;var r=e;if(r+=o?angular.toJson(o):"",r=btoa(r),n.hasOwnProperty(r))return n[r];n[r]=i.promise;try{t.get(e,o).success(i.resolve).error(c(i))}catch(a){i.reject(a.message)}return i.promise},d=function(e){var o=e+"Id",t=e+"Url";return function(e){return this[o]?u(this[t],e):s.defer().promise}},f=function(e){var o=e+"Id",i=e+"Url";return function(e){var r=s.defer();if(!this[i])return r.promise;var a=this[o]?"put":"post";return t[a](this[i],e).success(function(e){n={},e.method=a,r.resolve(e)}).error(c(r)),r.promise}},h=function(e){var o=e+"Id",i=e+"Url";return function(){var e=s.defer();return this[o]?(n={},t["delete"](this[i]).success(e.resolve).error(c(e)),e.promise):e.promise}},g=function(e){var o=e+"sUrl";return function(e){return u(this[o],e)}};return m.prototype.loadApp=d("app"),m.prototype.saveApp=f("app"),m.prototype.deleteApp=h("app"),m.prototype.loadForm=d("form"),m.prototype.saveForm=f("form"),m.prototype.deleteForm=h("form"),m.prototype.loadForms=g("form"),m.prototype.loadSubmission=d("submission"),m.prototype.saveSubmission=f("submission"),m.prototype.deleteSubmission=h("submission"),m.prototype.loadSubmissions=g("submission"),m.prototype.loadAction=d("action"),m.prototype.saveAction=f("action"),m.prototype.deleteAction=h("action"),m.prototype.loadActions=g("action"),m.prototype.availableActions=function(){return u(this.formUrl+"/actions")},m.loadApps=function(){return u(r(e)+"/app")},m.clearCache=function(){n={}},m.baseUrl=e,m.setUser=a.setUser.bind(a),m.getUser=a.getUser.bind(a),m.setToken=a.setToken.bind(a),m.getToken=a.getToken.bind(a),m.currentUser=function(){var o=s.defer(),n=this.getUser();if(n)return o.resolve(angular.fromJson(n)),o.promise;var i=this.getToken();return i?(t.get(e+"/current").success(function(e){this.setUser(e),o.resolve(e)}.bind(this)).error(c(o)),o.promise):(o.resolve(null),o.promise)},m.onLogout=p.promise,m.logout=function(){return t.get(e+"/logout").success(function(){this.setToken(null),this.setUser(null),p.resolve()}.bind(this)).error(function(){this.setToken(null),this.setUser(null),p.reject()}.bind(this)),m.onLogout},m.submissionData=function(e,o,t){if(!e)return"";if(o["protected"])return"--- PROTECTED ---";if(-1!==o.key.indexOf(".")){var n=e,i=o.key.split("."),r="",s=!1;return angular.forEach(i,function(e){return"_id"!==e&&n.hasOwnProperty("_id")&&(n=n.data),n.hasOwnProperty(e)?(n=n[e],s=!0,void(t&&(r+=e+".",t(r,n)))):void(s=!1)}),s?(e[o.key]=n,n):""}return e[o.key]},m}]}}),app.factory("FormioScope",["Formio","formioComponents",function(e,o){return{onError:function(e){return function(o){if("ValidationError"===o.name){angular.element("#form-group-"+o.details[0].path).addClass("has-error");var t="ValidationError: "+o.details[0].message;e.formioAlerts.push({type:"danger",message:t})}else e.formioAlerts.push({type:"danger",message:o});e.$emit("formError",o)}},register:function(t,n){var i=null;t._form=t.form||{},t._submission=t.submission||{data:{}},t._submissions=t.submissions||[];var r=function(o){return o?t.action?"":("/"===o.substr(0,1)&&(o=e.baseUrl+o),o):""};t.action=r(t.formAction);var s={};t.$on("addFormComponent",function(e,n){if(!s.hasOwnProperty(n.settings.key)){s[n.settings.key]=!0;var i=o.components[n.type];t._form.components.push(angular.extend(i.settings,n.settings))}}),t.$watch("form.action",function(e){if(e){var o=r(e);o&&(t.action=o)}}),t.submissionData=e.submissionData;var a=angular.element("#formio-loading");return t.src?(i=new e(t.src),n.form&&(a.show(),i.loadForm().then(function(e){t._form=e,a.hide(),t.$emit("formLoad",e)},this.onError(t))),n.submission&&(a.show(),i.loadSubmission().then(function(e){t._submission=e,a.hide(),t.$emit("submissionLoad",e)},this.onError(t))),n.submissions&&(a.show(),i.loadSubmissions().then(function(e){t._submissions=e,a.hide(),t.$emit("submissionsLoad",e)},this.onError(t)))):(t.formoLoaded=!0,a.hide(),t._form&&t.$emit("formLoad",t._form),t._submission&&t.$emit("submissionLoad",t._submission),t._submissions&&t.$emit("submissionsLoad",t._submissions)),i}}}]),app.factory("FormioUtils",function(){return{flattenComponents:function e(o,t){return t=t||{},angular.forEach(o,function(o){o.tree?t[o.key]=o:o.columns&&o.columns.length>0?angular.forEach(o.columns,function(o){e(o.components,t)}):o.components&&o.components.length>0?e(o.components,t):o.input&&(t[o.key]=o)}),t},fieldWrap:function(e){e+="<formio-errors></formio-errors>";var o=e.replace("data[component.key]","data[component.key][$index]"),t='<label ng-if="component.label && !component.hideLabel" for="{{ component.key }}" class="control-label">{{ component.label }}</label>',n='<span ng-if="component.validate.required" class="glyphicon glyphicon-asterisk form-control-feedback field-required" aria-hidden="true"></span>',i='<div ng-if="!component.multiple">'+t+n+'<div class="input-group" ng-if="component.prefix || component.suffix"><div class="input-group-addon" ng-if="!!component.prefix">{{ component.prefix }}</div>'+e+'<div class="input-group-addon" ng-if="!!component.suffix">{{ component.suffix }}</div></div><div ng-if="!component.prefix && !component.suffix">'+e+'</div></div><div ng-if="component.multiple"><table class="table table-bordered">'+t+'<tr ng-repeat="value in data[component.key] track by $index"><td>'+n+'<div class="input-group" ng-if="component.prefix || component.suffix"><div class="input-group-addon" ng-if="!!component.prefix">{{ component.prefix }}</div>'+o+'<div class="input-group-addon" ng-if="!!component.suffix">{{ component.suffix }}</div></div><div ng-if="!component.prefix && !component.suffix">'+o+'</div></td><td><a ng-click="removeFieldValue($index)" class="btn btn-danger"><span class="glyphicon glyphicon-remove-circle"></span></a></td></tr><tr><td colspan="2"><a ng-click="addFieldValue()" class="btn btn-primary"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add another</a></td></tr></table></div>';return i}}}),app.directive("formio",function(){return{restrict:"E",replace:!0,scope:{src:"=",formAction:"=",form:"=",submission:"="},controller:["$scope","$http","FormioScope","Formio","FormioUtils",function(e,o,t,n,i){e.formioAlerts=[],e.formio=t.register(e,{form:!0,submission:!0}),e.onSubmit=function(){if(e.formioForm.$valid){var r={data:{}};e._submission._id&&(r._id=e._submission._id),e._submission.data._id&&(r._id=e._submission.data._id);var s=i.flattenComponents(e._form.components);angular.forEach(s,function(o){e._submission.data.hasOwnProperty(o.key)&&(r.data[o.key]=e._submission.data[o.key])}),angular.forEach(e._submission.data,function(e,o){r.data.hasOwnProperty(o)&&!e.hasOwnProperty("_id")&&(r.data[o]=e)});var a=function(o,t){e.formioAlerts.push({type:"success",message:"Submission was "+("put"===o?"updated":"created")+"."}),e.$emit("formSubmission",t)};if(e.action){var l=r._id?"put":"post";o[l](e.action,r).success(function(e){n.clearCache(),a(l,e)}).error(t.onError(e))}else e.formio?e.formio.saveSubmission(r).then(function(e){a(e.method,e)},t.onError(e)):e.$emit("formSubmission",r)}}}],templateUrl:"formio.html"}}),app.directive("formioDelete",function(){return{restrict:"E",replace:!0,scope:{form:"=",submission:"=",src:"=",formAction:"=",resourceName:"="},templateUrl:"formio-delete.html",controller:["$scope","FormioScope","Formio","$http",function(e,o,t,n){e.formioAlerts=[];var i="resource",r="Resource",s="",a=o.register(e,{form:!0,submission:!0});a&&(i=a.submissionId?"submission":"form",r=i.charAt(0).toUpperCase()+i.slice(1),s="delete"+r),e._resourceName=e.resourceName||i,e.onDelete=function(){var i=function(o){e.formioAlerts.push({type:"success",message:r+" was deleted."}),t.clearCache(),e.$emit("delete",o)};if(e.action)n["delete"](e.action).success(i).error(o.onError(e));else if(a){if(!s)return;if("function"!=typeof a[s])return;a[s]().then(i,o.onError(e))}},e.onCancel=function(){e.$emit("cancel")}}]}}),app.filter("flattenComponents",["FormioUtils",function(e){return e.flattenComponents}]),app.filter("safehtml",["$sce",function(e){return function(o){return e.trustAsHtml(o)}}]),app.directive("formioErrors",function(){return{scope:!1,restrict:"E",templateUrl:"formio/errors.html"}}),app.directive("customValidator",function(){return{restrict:"A",require:"ngModel",link:function(scope,ele,attrs,ctrl){scope.component.validate&&scope.component.validate.custom&&ctrl.$parsers.unshift(function(input){var valid=!0;if(input){var custom=scope.component.validate.custom;custom=custom.replace(/({{\s+(.*)\s+}})/,function(e,o,t){return scope.data[t]}),valid=eval(custom),ctrl.$setValidity("custom",valid===!0)}return valid!==!0&&(scope.component.customError=valid),valid===!0?input:valid})}}}),app.directive("formioSubmissions",function(){return{replace:!0,restrict:"E",scope:{src:"=",form:"=",submissions:"="},templateUrl:"formio/submissions.html",controller:["$scope","FormioScope",function(e,o){o.register(e,{form:!0,submissions:!0})}]}}),app.directive("formioComponent",["Formio","formioComponents",function(e,o){return{replace:!0,restrict:"E",scope:{component:"=",data:"=",formio:"=",form:"="},templateUrl:"formio/component.html",controller:["$scope","$http",function(t,n){t.data||(t.data={}),t.component&&t.component.key&&-1!==t.component.key.indexOf(".")&&t.$watch("data",function(o){o&&!angular.equals({},o)&&e.submissionData(t.data,t.component,function(e,o){o.hasOwnProperty("_id")&&t.$emit("addFormComponent",{type:"hidden",settings:{key:e+"_id"}})})});var i=o.components[t.component.type];if(angular.forEach(i.settings,function(e,o){t.component.hasOwnProperty(o)||(t.component[o]=e)}),t.addFieldValue=function(){t.data[t.component.key].push("")},t.removeFieldValue=function(e){t.data[t.component.key].splice(e,1)},t.template="function"==typeof i.template?i.template(t):i.template,t.component.key&&-1!==t.component.key.indexOf("[")){var r=t.component.key.match(/([^\[]+)\[([^]+)\]/);3===r.length&&t.data.hasOwnProperty(r[1])&&(t.data=t.data[r[1]],t.component.key=r[2])}t.data&&!t.data.hasOwnProperty(t.component.key)&&t.component.hasOwnProperty("defaultValue")&&(t.data[t.component.key]=t.component.multiple?[t.component.defaultValue]:t.component.defaultValue),i.controller&&i.controller(t.component,t,n,e)}]}}]),app.directive("formioElement",["$compile","$templateCache",function(e,o){return{scope:!1,link:function(t,n){n.replaceWith(e(o.get(t.template))(t))}}}]),app.directive("formioInputMask",function(){return{restrict:"A",link:function(e,o,t){t.formioInputMask&&o.mask(t.formioInputMask)}}}),app.factory("formioInterceptor",["$q",function(e){var o={token:"",setToken:function(e){return e=e||"",e!==this.token?(this.token=e,e?void localStorage.setItem("formioToken",e):(this.setUser(null),localStorage.removeItem("formioToken"))):void 0},getToken:function(){if(this.token)return this.token;var e=localStorage.getItem("formioToken")||"";return this.token=e,e},setUser:function(e){return e?void localStorage.setItem("formioUser",angular.toJson(e)):(this.setToken(null),localStorage.removeItem("formioUser"))},getUser:function(){return localStorage.getItem("formioUser")}};return o.response=function(e){var o=e.headers("x-jwt-token");return(o||""===o)&&this.setToken(o),e}.bind(o),o.responseError=function(o){return 401===parseInt(o.status,10)&&(o.loggedOut=!0,this.setToken(null)),e.reject(o)}.bind(o),o.request=function(e){if(e.disableJWT)return e;var o=this.getToken();return o&&(e.headers["x-jwt-token"]=o),e}.bind(o),o}]),app.config(["$httpProvider",function(e){e.interceptors.push("formioInterceptor")}]),app.run(["$templateCache",function(e){e.put("formio.html",'<form role="form" name="formioForm" ng-submit="onSubmit()" novalidate><i id="formio-loading" style="font-size: 2em;" class="fa fa-spinner fa-pulse"></i><div ng-repeat="alert in formioAlerts" class="alert alert-{{ alert.type }}" role="alert">{{ alert.message }}</div><formio-component ng-repeat="component in _form.components track by $index" component="component" data="_submission.data" form="formioForm" formio="formio"></formio-component></form>'),e.put("formio-delete.html",'<form role="form"><div ng-repeat="alert in formioAlerts" class="alert alert-{{ alert.type }}" role="alert">{{ alert.message }}</div><h3>Are you sure you wish to delete the {{ _resourceName }}?</h3><div class="btn-toolbar"><button ng-click="onDelete()" class="btn btn-danger">Yes</button><button ng-click="onCancel()" class="btn btn-default">No</button></div></form>'),e.put("formio/submissions.html",'<table class="table"><thead><tr><th ng-repeat="component in _form.components | flattenComponents">{{ component.label }}</th><th>Submitted</th><th>Updated</th><th>Operations</th></tr></thead><tbody><tr ng-repeat="submission in _submissions"><td ng-repeat="component in _form.components | flattenComponents">{{ submissionData(submission.data, component) }}</td><td>{{ submission.created | amDateFormat:\'l, h:mm:ss a\' }}</td><td>{{ submission.modified | amDateFormat:\'l, h:mm:ss a\' }}</td><td><div class="button-group" style="display:flex;"><a ng-click="$emit(\'submissionView\', submission)" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-eye-open"></span></a>&nbsp;<a ng-click="$emit(\'submissionEdit\', submission)" class="btn btn-default btn-xs"><span class="glyphicon glyphicon-edit"></span></a>&nbsp;<a ng-click="$emit(\'submissionDelete\', submission)" class="btn btn-danger btn-xs"><span class="glyphicon glyphicon-remove-circle"></span></a></div></td></tr></tbody></table>'),e.put("formio/component.html",'<ng-form name="formioFieldForm"><div class="form-group has-feedback form-field-type-{{ component.type }}" id="form-group-{{ component.key }}" ng-class="{\'has-error\': formioFieldForm[component.key].$invalid && !formioFieldForm[component.key].$pristine }"><formio-element></formio-element></div></ng-form>'),e.put("formio/errors.html",'<div ng-show="formioFieldForm[component.key].$error && !formioFieldForm[component.key].$pristine"><p class="help-block" ng-show="formioFieldForm[component.key].$error.email">{{ component.label }} must be a valid email.</p><p class="help-block" ng-show="formioFieldForm[component.key].$error.required">{{ component.label }} is required.</p><p class="help-block" ng-show="formioFieldForm[component.key].$error.number">{{ component.label }} must be a number.</p><p class="help-block" ng-show="formioFieldForm[component.key].$error.maxlength">{{ component.label }} must be shorter than {{ component.validate.maxLength + 1 }} characters.</p><p class="help-block" ng-show="formioFieldForm[component.key].$error.minlength">{{ component.label }} must be longer than {{ component.validate.minLength - 1 }} characters.</p><p class="help-block" ng-show="formioFieldForm[component.key].$error.min">{{ component.label }} must be higher than {{ component.validate.min - 1 }}.</p><p class="help-block" ng-show="formioFieldForm[component.key].$error.max">{{ component.label }} must be lower than {{ component.validate.max + 1 }}.</p><p class="help-block" ng-show="formioFieldForm[component.key].$error.custom">{{ component.customError }}</p></div>')}]),app.provider("formioComponents",function(){var e={},o={__component:{title:"Form Components"},layout:{title:"Layout Components"}};return{addGroup:function(e,t){o[e]=t},register:function(o,t,n){e[o]?angular.extend(e[o],t):e[o]=t,e[o].group||(e[o].group=n||"__component"),e[o].settings.type=o},$get:function(){return{components:e,groups:o}}}}),app.config(["formioComponentsProvider",function(e){e.register("textfield",{title:"Text Field",template:"formio/components/textfield.html",settings:{input:!0,inputType:"text",inputMask:"",label:"",key:"",placeholder:"",prefix:"",suffix:"",multiple:!1,defaultValue:"","protected":!1,unique:!1,persistent:!0,validate:{required:!1,minLength:"",maxLength:"",pattern:"",custom:"",customPrivate:!1}}})}]),app.run(["$templateCache","FormioUtils",function(e,o){e.put("formio/components/textfield.html",o.fieldWrap('<input type="{{ component.inputType }}" class="form-control" id="{{ component.key }}" name="{{ component.key }}" ng-model="data[component.key]" ng-required="component.validate.required" ng-minlength="component.validate.minLength" ng-maxlength="component.validate.maxLength" custom-validator="component.validate.custom" placeholder="{{ component.placeholder }}" formio-input-mask="{{ component.inputMask }}">'))}]),app.config(["formioComponentsProvider",function(e){e.register("address",{title:"Address",template:function(e){return e.component.multiple?"formio/components/address-multiple.html":"formio/components/address.html"},controller:function(e,o,t){o.address={},o.addresses=[],o.refreshAddress=function(e){var n={address:e,sensor:!1};return t.get("https://maps.googleapis.com/maps/api/geocode/json",{disableJWT:!0,params:n,headers:{Authorization:void 0}}).then(function(e){o.addresses=e.data.results})}},settings:{input:!0,label:"",key:"",placeholder:"",multiple:!1}})}]),app.run(["$templateCache",function(e){e.put("formio/components/address.html",'<label ng-if="component.label" for="{{ component.key }}">{{ component.label }}</label><ui-select ng-model="data[component.key]" id="{{ component.key }}" theme="bootstrap"><ui-select-match placeholder="{{ component.placeholder }}">{{$item.formatted_address || $select.selected.formatted_address}}</ui-select-match><ui-select-choices repeat="address in addresses track by $index" refresh="refreshAddress($select.search)" refresh-delay="1000"><div ng-bind-html="address.formatted_address | highlight: $select.search"></div></ui-select-choices></ui-select>'),e.put("formio/components/address-multiple.html",e.get("formio/components/address.html").replace("<ui-select","<ui-select multiple"))}]),app.config(["formioComponentsProvider",function(e){e.register("button",{title:"Button",template:"formio/components/button.html",settings:{input:!0,label:"Submit",key:"submit",size:"md",leftIcon:"",rightIcon:"",block:!1,action:"submit",disableOnInvalid:!0,theme:"primary"}})}]),app.run(["$templateCache",function(e){e.put("formio/components/button.html",'<button ng-class="{\'btn-block\': component.block}" class="btn btn-{{ component.theme }} btn-{{ component.size }}" ng-disabled="component.disableOnInvalid && form.$invalid" ng-click="$emit(component.action)"><span ng-if="component.leftIcon" class="{{ component.leftIcon }}" aria-hidden="true"></span><span ng-if="component.leftIcon && component.label">&nbsp;</span>{{ component.label }}<span ng-if="component.rightIcon && component.label">&nbsp;</span><span ng-if="component.rightIcon" class="{{ component.rightIcon }}" aria-hidden="true"></span></button>')}]),app.config(["formioComponentsProvider",function(e){e.register("checkbox",{title:"Check Box",template:"formio/components/checkbox.html",settings:{input:!0,inputType:"checkbox",hideLabel:!0,label:"",key:"",prefix:"",suffix:"",defaultValue:!1,"protected":!1,persistent:!0,validate:{required:!1}}})}]),app.run(["$templateCache","FormioUtils",function(e,o){e.put("formio/components/checkbox.html",o.fieldWrap('<div class="checkbox"><label for={{ component.key }}><input type="{{ component.inputType }}" id="{{ component.key }}" name="{{ component.key }}" value="{{ component.key }}" ng-model="data[component.key]" ng-required="component.validate.required">{{ component.label }}</label></div>'))}]),app.config(["formioComponentsProvider",function(e){e.register("columns",{title:"Columns",template:"formio/components/columns.html",group:"layout",settings:{input:!1,columns:[{components:[]},{components:[]}]}})}]),app.run(["$templateCache",function(e){e.put("formio/components/columns.html",'<div class="row"><div class="col-xs-6" ng-repeat="column in component.columns"><formio-component ng-repeat="component in column.components" component="component" data="data" formio="formio"></formio-component></div></div>')}]),app.config(["formioComponentsProvider",function(e){e.register("content",{title:"Content",template:"formio/components/content.html",settings:{input:!1,html:""}})}]),app.run(["$templateCache",function(e){e.put("formio/components/content.html",'<div ng-bind-html="component.html | safehtml"></div>')}]),app.config(["formioComponentsProvider",function(e){e.register("datetime",{title:"Date / Time",template:"formio/components/datetime.html",settings:{input:!0,label:"",key:"",placeholder:"",format:"yyyy-MM-dd HH:mm",enableDate:!0,enableTime:!0,minDate:null,maxDate:null,datepickerMode:"day",datePicker:{showWeeks:!0,startingDay:0,initDate:"",minMode:"day",maxMode:"year",yearRange:"20"},timePicker:{hourStep:1,minuteStep:1,showMeridian:!0,readonlyInput:!1,mousewheel:!0,arrowkeys:!0},"protected":!1,persistent:!0,validate:{required:!1,custom:""}}})}]),app.run(["$templateCache","FormioUtils",function(e,o){e.put("formio/components/datetime.html",o.fieldWrap('<div class="input-group"><input type="text" class="form-control" ng-focus="calendarOpen = true" ng-click="calendarOpen = true" ng-init="calendarOpen = false" is-open="calendarOpen" datetime-picker="{{ component.format }}" min-date="component.minDate" max-date="component.maxDate" datepicker-mode="component.datepickerMode" enable-date="component.enableDate" enable-time="component.enableTime" ng-model="data[component.key]" placeholder="{{ component.placeholder }}" datepicker-options="component.datePicker" timepicker-options="component.timePicker" /><span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="calendarOpen = true"><i ng-if="component.enableDate" class="fa fa-calendar"></i><i ng-if="!component.enableDate" class="fa fa-clock-o"></i></button></span></div>'))}]),app.config(["formioComponentsProvider",function(e){e.register("email",{title:"Email",template:"formio/components/textfield.html",settings:{input:!0,inputType:"email",label:"",key:"",placeholder:"",prefix:"",suffix:"",defaultValue:"","protected":!1,unique:!1,persistent:!0}})}]),app.config(["formioComponentsProvider",function(e){e.register("fieldset",{title:"Field Set",template:"formio/components/fieldset.html",settings:{input:!1,legend:"",key:"",components:[]}})}]),app.run(["$templateCache",function(e){e.put("formio/components/fieldset.html",'<fieldset><legend ng-if="component.legend">{{ component.legend }}</legend><formio-component ng-repeat="component in component.components" component="component" data="data" formio="formio"></formio-component></fieldset>')}]),app.constant("AMAZON_S3",{publicAccessKey:"AKIAJTNEPGLXAIYPOYYA",bucket:"formio-files",endpoint:"/storage/s3"}),app.directive("formioFileInput",function(){return{require:"ngModel",restrict:"E",scope:!0,replace:!0,template:'<div class="input-group"><span class="input-group-btn"><span class="btn btn-primary" style="position: relative; overflow: hidden;"><input type="file" style="position: absolute; top: 0; right: 0; min-width: 100%; min-height: 100%; font-size: 100px; text-align: right; filter: alpha(opacity=0); opacity: 0; outline: none; background: white; cursor: inherit; display: block;" id="{{ component.key }}" onchange="angular.element(this).scope().fileChanged(this)"/><i class="glyphicon glyphicon-folder-open"></i> &nbsp;Browse…</span><button class="btn btn-default" ng-show="fileInput.value" ng-click="removeFile()"><i class="glyphicon glyphicon-remove-circle"></i> Cancel</button></span><input type="text" class="form-control" value="{{ fileInput.files[0].name || fileInput.value  }}" readonly placeholder="Select a file…" ng-if="!uploading"/><div class="progress" ng-if="uploading" style="height: 39px; margin-bottom: 0;"><div class="progress-bar progress-bar-striped active" role="progressbar" ng-style="{ \'width\': uploadedPercent }" style="padding-top: 5px;">{{ uploadedPercent }}</div></div></div>',controller:["$scope","$timeout","FormioS3FileUploader","AMAZON_S3",function(e,o,t,n){e.uploading=!1,e.fileChanged=function(i){e.$apply(function(){e.fileInput=i,""!==i.value&&(e.uploader=t.create({formId:e.formio.formId,componentKey:e.component.key,minSizeLimit:e.component.validate.minSizeLimit,maxSizeLimit:e.component.validate.maxSizeLimit,allowedExtensions:e.component.validate.allowedExtensions||[],onComplete:function(o,t,i){if(e.uploading=!1,i.success){var r="http://"+n.bucket+".s3.amazonaws.com/"+e.uploader.getKey(o);e.$broadcast("fileChanged",r)}},onError:function(t,n,i){o(function(){e.fileInput=null}),e.$broadcast("error",i)},onCancel:function(){e.uploading=!1,e.$broadcast("fileChanged","")},onUploadStart:function(){e.uploading=!0,e.uploadedPercent="0%",e.$broadcast("uploadStart")},onProgress:function(o,t,n,i){e.$apply(function(){e.uploadedBytes=n,e.totalBytes=i,e.uploadedPercent=(n/i*100).toFixed(0)+"%"})}}),e.uploader.addFiles(i))})},e.removeFile=function(){e.uploader&&(e.uploader.cancelAll(),e.uploader=null),e.fileInput&&(e.fileInput=null),e.$broadcast("fileChanged","")}}],link:function(e,o,t,n){n.$isEmpty=function(e){return!e};var i=function(e){console.log("updateValue",e),n.$setViewValue(e),n.$setDirty(),n.$render()};e.$on("uploadStart",function(){n.$setValidity("uploading",!1)}),e.$on("fileChanged",function(o,t){n.$setValidity("uploading",!0),""!==t&&(e.component.customError="",n.$setValidity("custom",!0)),i(t)}),e.$on("error",function(o,t){e.component.customError=t,n.$setValidity("custom",!1),i("")})}}}),app.factory("FormioS3FileUploader",["Formio","formioInterceptor","AMAZON_S3",function(e,o,t){var n=function(n){var i=new qq.s3.FineUploaderBasic({debug:!0,autoUpload:!0,cors:{expected:!0},chunking:{enabled:!1},validation:{minSizeLimit:n.minSizeLimit,sizeLimit:n.maxSizeLimit,allowedExtensions:n.allowedExtensions},request:{endpoint:t.bucket+".s3.amazonaws.com",accessKey:t.publicAccessKey},signature:{endpoint:e.baseUrl+t.endpoint,customHeaders:{"x-jwt-token":o.getToken(),"x-formio-form-id":n.formId,"x-formio-component-key":n.componentKey}},callbacks:{onComplete:n.onComplete,onError:n.onError,onCancel:n.onCancel,onUpload:n.onUploadStart,onProgress:n.onProgress}});return i};return{create:n}}]),app.config(["formioComponentsProvider",function(e){e.register("file",{title:"File Upload",template:"formio/components/file.html",settings:{input:!0,label:"",key:"",placeholder:"",multiple:!1,"protected":!1,persistent:!0,validate:{required:!1,minSizeLimit:"0",maxSizeLimit:"10000000"}}})}]),app.run(["$templateCache","FormioUtils",function(e,o){e.put("formio/components/file.html",o.fieldWrap('<formio-file-input component="component" name="{{ component.key }}" ng-model="data[component.key]" ng-required="component.validate.required"></formio-file-input>'))}]),app.config(["formioComponentsProvider",function(e){e.register("hidden",{title:"Hidden",template:"formio/components/hidden.html",settings:{input:!0,key:"",label:"","protected":!1,unique:!1,persistent:!0}})}]),app.run(["$templateCache",function(e){e.put("formio/components/hidden.html",'<input type="hidden" id="{{ component.key }}" name="{{ component.key }}" ng-model="data[component.key]">')}]),app.config(["formioComponentsProvider",function(e){e.register("number",{title:"Number",template:"formio/components/number.html",settings:{input:!0,inputType:"number",label:"",key:"",placeholder:"",prefix:"",suffix:"",defaultValue:"",validate:{required:!1,min:"",max:"",step:"any",integer:"",multiple:"",custom:""}}})}]),app.run(["$templateCache","FormioUtils",function(e,o){e.put("formio/components/number.html",o.fieldWrap('<input type="{{ component.inputType }}" class="form-control" id="{{ component.key }}" name="{{ component.key }}" ng-model="data[component.key]" ng-required="component.validate.required" min="{{ component.validate.min }}" max="{{ component.validate.max }}" step="{{ component.validate.step }}" placeholder="{{ component.placeholder }}" custom-validator="component.validate.custom" formio-input-mask="{{ component.inputMask }}">'))}]),app.config(["formioComponentsProvider",function(e){e.register("page",{template:"formio/components/page.html",settings:{input:!1,components:[]}})}]),app.run(["$templateCache",function(e){e.put("formio/components/page.html",'<formio-component ng-repeat="component in component.components" component="component" data="data" formio="formio"></formio-component>')}]),app.config(["formioComponentsProvider",function(e){e.register("panel",{title:"Panel",template:"formio/components/panel.html",group:"layout",settings:{input:!1,title:"",theme:"default",components:[]}})}]),app.run(["$templateCache",function(e){e.put("formio/components/panel.html",'<div class="panel panel-{{ component.theme }}"><div ng-if="component.title" class="panel-heading"><h3 class="panel-title">{{ component.title }}</h3></div><div class="panel-body"><formio-component ng-repeat="component in component.components" component="component" data="data" formio="formio"></formio-component></div></div>')}]),app.config(["formioComponentsProvider",function(e){e.register("password",{title:"Password",template:"formio/components/textfield.html",settings:{input:!0,inputType:"password",label:"",key:"",placeholder:"",prefix:"",suffix:"","protected":!0,persistent:!0}})}]),app.config(["formioComponentsProvider",function(e){e.register("phoneNumber",{title:"Phone Number",template:"formio/components/phoneNumber.html",settings:{input:!0,inputMask:"(999) 999-9999",label:"",key:"",placeholder:"",prefix:"",suffix:""}})}]),app.run(["$templateCache",function(e){e.put("formio/components/phoneNumber.html",'<label ng-if="component.label" for="{{ component.key }}">{{ component.label }}</label><div class="input-group" ng-if="component.prefix || component.suffix"><div class="input-group-addon" ng-if="!!component.prefix">{{ component.prefix }}</div><input type="text" class="form-control" ng-model="data[component.key]" id="{{ component.key }}" placeholder="{{ component.placeholder }}" formio-input-mask="{{ component.inputMask }}"><div class="input-group-addon" ng-if="!!component.suffix">{{ component.suffix }}</div></div><input ng-if="!component.prefix && !component.suffix" type="text" class="form-control" ng-model="data[component.key]" id="{{ component.key }}" placeholder="{{ component.placeholder }}" formio-input-mask="{{ component.inputMask }}">');

}]),app.config(["formioComponentsProvider",function(e){e.register("radio",{title:"Radio",template:"formio/components/radio.html",settings:{input:!0,inputType:"radio",label:"",key:"",values:[{value:"value1",label:"Value 1"},{value:"value2",label:"Value 2"}],defaultValue:"","protected":!1,persistent:!0,validate:{required:!1,custom:"",customPrivate:!1}}})}]),app.run(["$templateCache","FormioUtils",function(e,o){e.put("formio/components/radio.html",o.fieldWrap('<div class="radio" ng-repeat="v in component.values track by $index"><label class="control-label" for="value"><input type="{{ component.inputType }}" id="{{ v.value }}" name="{{ component.key }}" value="{{ v.value }}" ng-model="data[component.key]" ng-required="component.validate.required" custom-validator="component.validate.custom">{{ v.label }}</label></div>'))}]),app.config(["formioComponentsProvider",function(e){e.register("resource",{title:"Resource",template:function(e){return e.component.multiple?"formio/components/resource-multiple.html":"formio/components/resource.html"},controller:function(e,o,t,n){if(o.selectItems=[],e.resource){var i=new n(o.formio.appUrl+"/form/"+e.resource);if(e.searchExpression&&e.searchFields){var r=new RegExp(e.searchExpression);o.refreshSubmissions=function(t){if(!t)return[];var n=t.match(r),s={},a=!1;n&&n.length>1&&angular.forEach(e.searchFields,function(e,o){n.length>o+1&&n[o+1]&&(s[e]=n[o+1],a=!0)}),a&&i.loadSubmissions({params:s}).then(function(e){o.selectItems=e||[]})}}else o.refreshSubmissions=function(){},i.loadSubmissions().then(function(e){o.selectItems=e||[]})}},settings:{input:!0,label:"",key:"",placeholder:"",resource:"",template:"<span>{{ item.data }}</span>",searchExpression:"",searchFields:"",multiple:!1,refresh:!1,refreshDelay:0}})}]),app.run(["$templateCache",function(e){e.put("formio/components/resource.html",'<label ng-if="component.label" for="{{ component.key }}">{{ component.label }}</label><ui-select ng-model="data[component.key]" id="{{ component.key }}" theme="bootstrap"><ui-select-match placeholder="{{ component.placeholder }}"><formio-select-item template="component.template" item="$item || $select.selected" select="$select"></formio-select-item></ui-select-match><ui-select-choices repeat="item in selectItems | filter: $select.search" refresh="refreshSubmissions($select.search)" refresh-delay="1000"><formio-select-item template="component.template" item="item" select="$select"></formio-select-item></ui-select-choices></ui-select>'),e.put("formio/components/resource-multiple.html",e.get("formio/components/resource.html").replace("<ui-select","<ui-select multiple"))}]),app.directive("formioSelectItem",["$compile",function(e){return{restrict:"E",scope:{template:"=",item:"=",select:"="},link:function(o,t){o.template&&t.html(e(angular.element(o.template))(o))}}}]),app.config(["formioComponentsProvider",function(e){e.register("select",{title:"Select",template:function(e){return e.component.multiple?"formio/components/select-multiple.html":"formio/components/select.html"},controller:function(e,o,t,n){o.nowrap=!0,o.selectItems=[];var i=o.component.valueProperty;if(o.getSelectItem=function(e){return i?e[i]:e},"/"===e.dataSrc.substr(0,1)&&(e.dataSrc=n.baseUrl+e.dataSrc),"http"===e.dataSrc.substr(0,4))t.get(e.dataSrc).success(function(e){o.selectItems=e});else if(e.dataSrc)try{o.selectItems=angular.fromJson(e.dataSrc)}catch(r){o.selectItems=[]}},settings:{input:!0,label:"",key:"",placeholder:"",dataSrc:"",valueProperty:"",template:"<span>{{ item }}</span>",multiple:!1,refresh:!1,refreshDelay:0,"protected":!1,unique:!1,persistent:!0}})}]),app.run(["$templateCache",function(e){e.put("formio/components/select.html",'<label ng-if="component.label" for="{{ component.key }}">{{ component.label }}</label><ui-select ng-model="data[component.key]" id="{{ component.key }}" theme="bootstrap"><ui-select-match placeholder="{{ component.placeholder }}"><formio-select-item template="component.template" item="$item || $select.selected" select="$select"></formio-select-item></ui-select-match><ui-select-choices repeat="getSelectItem(item) as item in selectItems | filter: $select.search"><formio-select-item template="component.template" item="item" select="$select"></formio-select-item></ui-select-choices></ui-select>'),e.put("formio/components/select-multiple.html",e.get("formio/components/select.html").replace("<ui-select","<ui-select multiple"))}]),app.config(["formioComponentsProvider",function(e){e.register("signature",{title:"Signature",template:"formio/components/signature.html",settings:{input:!0,label:"",key:"signature",placeholder:"",footer:"Sign above",width:"100%",height:"150",penColor:"black",backgroundColor:"rgb(245,245,235)",minWidth:"0.5",maxWidth:"2.5"}})}]),app.directive("signature",function(){return{restrict:"A",scope:{component:"="},require:"?ngModel",link:function(e,o,t,n){function i(){var e=s.toDataURL();n.$setViewValue(e)}if(n){var r=function(t){if("%"===e.component[t].slice(-1)){var n=parseFloat(e.component[t].slice(0,-1))/100;o[0][t]=o.parent()[t]()*n}else o[0][t]=parseInt(e.component[t],10)};r("width"),r("height");var s=new SignaturePad(o[0],{minWidth:e.component.minWidth,maxWidth:e.component.maxWidth,penColor:e.component.penColor,backgroundColor:e.component.backgroundColor});e.component.clearSignature=function(){s.clear()},o.css({"border-radius":"4px","box-shadow":"0 0 5px rgba(0, 0, 0, 0.02) inset",border:"1px solid #f4f4f4"}),n.$render=function(){s.fromDataURL(n.$viewValue)},s.onEnd=function(){e.$evalAsync(i)},i()}}}}),app.run(["$templateCache","FormioUtils",function(e,o){e.put("formio/components/signature.html",o.fieldWrap('<a class="btn btn-xs btn-default" style="position:absolute; left: 0; top: 0; z-index: 1000" ng-click="component.clearSignature()"><span class="glyphicon glyphicon-repeat"></span></a><canvas signature component="component" ng-model="data[component.key]"></canvas><div class="formio-signature-footer" style="text-align: center;color:#C3C3C3;">{{ component.footer }}</div>'))}]),app.config(["formioComponentsProvider",function(e){e.register("textarea",{title:"Text Area",template:"formio/components/textarea.html",settings:{input:!0,label:"",key:"",placeholder:"",prefix:"",suffix:"",rows:3,multiple:!1,defaultValue:"",validate:{required:!1,minLength:"",maxLength:"",pattern:"",custom:""}}})}]),app.run(["$templateCache","FormioUtils",function(e,o){e.put("formio/components/textarea.html",o.fieldWrap('<textarea class="form-control" ng-model="data[component.key]" id="{{ component.key }}" placeholder="{{ component.placeholder }}" custom-validator="component.validate.custom" rows="{{ component.rows }}"></textarea>'))}]),app.config(["formioComponentsProvider",function(e){e.register("well",{title:"Well",template:"formio/components/well.html",group:"layout",settings:{input:!1,components:[]}})}]),app.run(["$templateCache",function(e){e.put("formio/components/well.html",'<div class="well"><formio-component ng-repeat="component in component.components" component="component" data="data" formio="formio"></formio-component></div>')}])}();